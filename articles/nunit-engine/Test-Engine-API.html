<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html lang="en">

  <head>
    <meta charset="utf-8">
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-PCB5BYBNM2"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() { dataLayer.push(arguments); }
      gtag('js', new Date());
      gtag('config', 'G-PCB5BYBNM2');
    </script>
      <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
      <title>Test Engine API | NUnit Docs </title>
      <meta name="viewport" content="width=device-width">
      <meta name="title" content="Test Engine API | NUnit Docs ">
    
    
      <link rel="shortcut icon" href="../../favicon.ico">
      <link rel="stylesheet" href="../../styles/docfx.vendor.min.css">
      <link rel="stylesheet" href="../../styles/docfx.css">
      <link rel="stylesheet" href="../../styles/main.css">
      <meta property="docfx:navrel" content="../../toc.html">
      <meta property="docfx:tocrel" content="../toc.html">
    
    <meta property="docfx:rel" content="../../">
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>

        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>

              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>

        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">

        <div id="search-results">
          <div class="search-list">Search Results for <span></span></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination" data-first=First data-prev=Previous data-next=Next data-last=Last></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">

        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="testengineapi">
<h1 id="test-engine-api">Test Engine API</h1>

<p>The NUnit Test Engine API is our published API for discovering, exploring and executing tests programmatically.
Third-party test runners should use the Engine API as the supported method to execute NUnit tests.</p>
<h2 id="overview">Overview</h2>
<p>The static class
<a href="https://github.com/nunit/nunit-console/blob/main/src/NUnitEngine/nunit.engine.api/TestEngineActivator.cs">TestEngineActivator</a>
is used to get an interface to the engine. Its <code>CreateInstance</code> member has two overloads, depending on whether a
particular minimum version of the engine is required.</p>
<pre><code class="lang-csharp">public static ITestEngine CreateInstance(bool unused = false);
public static ITestEngine CreateInstance(Version minVersion, bool unused = false);
</code></pre>
<p>(The <code>unused</code> bool parameter previously allowed users to indicate if wished to restrict usage of global NUnit Engine
installations. The latter functionality is no longer available.)</p>
<p>The TestEngineActivator searches for an engine to load in two places. First, the current App Domain Base Directory is
searched, and then any path set as the App Domain's <code>RelativeSearchPath</code>.</p>
<h3 id="key-interfaces">Key Interfaces</h3>
<p>The runner deals with the engine through a set of interfaces. These are quite general because we hope to avoid many
changes to this API.</p>
<h4 id="itestengine">ITestEngine</h4>
<p>This is the primary interface to the engine.</p>
<pre><code class="lang-csharp">namespace NUnit.Engine
{
    /// &lt;summary&gt;
    /// ITestEngine represents an instance of the test engine.
    /// Clients wanting to discover, explore or run tests start
    /// require an instance of the engine, which is generally
    /// acquired from the TestEngineActivator class.
    /// &lt;/summary&gt;
    public interface ITestEngine : IDisposable
    {
        /// &lt;summary&gt;
        /// Gets the IServiceLocator interface, which gives access to
        /// certain services provided by the engine.
        /// &lt;/summary&gt;
        IServiceLocator Services { get; }

        /// &lt;summary&gt;
        /// Gets and sets the directory path used by the engine for saving files.
        /// Some services may ignore changes to this path made after initialization.
        /// The default value is the current directory.
        /// &lt;/summary&gt;
        string WorkDirectory { get; set;  }

        /// &lt;summary&gt;
        /// Gets and sets the InternalTraceLevel used by the engine. Changing this
        /// setting after initialization will have no effect. The default value
        /// is the value saved in the NUnit settings.
        /// &lt;/summary&gt;
        InternalTraceLevel InternalTraceLevel { get; set; }

        /// &lt;summary&gt;
        /// Initialize the engine. This includes setting the trace level and
        /// creating the standard set of services used in the Engine.
        ///
        /// This interface is not recommended to be called by user code. The TestEngineActivator
        /// will provide a pre-initialized engine, which should be used as provided.
        /// &lt;/summary&gt;
        void Initialize();

        /// &lt;summary&gt;
        /// Returns a test runner instance for use by clients in discovering,
        /// exploring and executing tests.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;package&quot;&gt;The TestPackage for which the runner is intended.&lt;/param&gt;
        /// &lt;returns&gt;An ITestRunner.&lt;/returns&gt;
        ITestRunner GetRunner(TestPackage package);
    }
}
</code></pre>
<p>The normal sequence of calls for initially acquiring this interface is:</p>
<pre><code class="lang-csharp">ITestEngine engine = TestEngineActivator.CreateInstance(...);
engine.WorkDirectory = ...;         // Defaults to the current directory
engine.InternalTraceLevel = ...;    // Defaults to off
</code></pre>
<p>The engine provides a number of services, some internal and some public. Public services are those for which the
interface is publicly defined in the nunit.engine.api assembly, listed later in this document.</p>
<p>The final and probably most frequently used method on the interface is <code>GetRunner</code>. It takes a <code>TestPackage</code> and returns
an <code>ITestRunner</code> that is appropriate for the options specified.</p>
<h4 id="itestrunner">ITestRunner</h4>
<p>This interface allows loading test assemblies, exploring the tests contained in them and running the tests.</p>
<pre><code class="lang-csharp">namespace NUnit.Engine
{
    /// &lt;summary&gt;
    /// Interface implemented by all test runners.
    /// &lt;/summary&gt;
    public interface ITestRunner : IDisposable
    {
        /// &lt;summary&gt;
        /// Get a flag indicating whether a test is running
        /// &lt;/summary&gt;
        bool IsTestRunning { get; }

        /// &lt;summary&gt;
        /// Load a TestPackage for possible execution
        /// &lt;/summary&gt;
        /// &lt;returns&gt;An XmlNode representing the loaded package.&lt;/returns&gt;
        /// &lt;remarks&gt;
        /// This method is normally optional, since Explore and Run call
        /// it automatically when necessary. The method is kept in order
        /// to make it easier to convert older programs that use it.
        /// &lt;/remarks&gt;
        XmlNode Load();

        /// &lt;summary&gt;
        /// Unload any loaded TestPackage. If none is loaded,
        /// the call is ignored.
        /// &lt;/summary&gt;
        void Unload();

        /// &lt;summary&gt;
        /// Reload the current TestPackage
        /// &lt;/summary&gt;
        /// &lt;returns&gt;An XmlNode representing the loaded package.&lt;/returns&gt;
        XmlNode Reload();

        /// &lt;summary&gt;
        /// Count the test cases that would be run under
        /// the specified filter.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;filter&quot;&gt;A TestFilter&lt;/param&gt;
        /// &lt;returns&gt;The count of test cases&lt;/returns&gt;
        int CountTestCases(TestFilter filter);

        /// &lt;summary&gt;
        /// Run the tests in the loaded TestPackage and return a test result. The tests
        /// are run synchronously and the listener interface is notified as it progresses.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;listener&quot;&gt;The listener that is notified as the run progresses&lt;/param&gt;
        /// &lt;param name=&quot;filter&quot;&gt;A TestFilter used to select tests&lt;/param&gt;
        /// &lt;returns&gt;An XmlNode giving the result of the test execution&lt;/returns&gt;
        XmlNode Run(ITestEventListener listener, TestFilter filter);

        /// &lt;summary&gt;
        /// Start a run of the tests in the loaded TestPackage. The tests are run
        /// asynchronously and the listener interface is notified as it progresses.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;listener&quot;&gt;The listener that is notified as the run progresses&lt;/param&gt;
        /// &lt;param name=&quot;filter&quot;&gt;A TestFilter used to select tests&lt;/param&gt;
        /// &lt;returns&gt;&lt;/returns&gt;
        ITestRun RunAsync(ITestEventListener listener, TestFilter filter);

        /// &lt;summary&gt;
        /// Cancel the ongoing test run. If no test is running, the call is ignored.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;force&quot;&gt;If true, cancel any ongoing test threads, otherwise wait for them to complete.&lt;/param&gt;
        void StopRun(bool force);

        /// &lt;summary&gt;
        /// Explore a loaded TestPackage and return information about the tests found.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;filter&quot;&gt;The TestFilter to be used in selecting tests to explore.&lt;/param&gt;
        /// &lt;returns&gt;An XmlNode representing the tests found.&lt;/returns&gt;
        XmlNode Explore(TestFilter filter);
    }
}
</code></pre>
<p>For the most common use cases, it isn't necessary to call <code>Load</code>, <code>Unload</code> or <code>Reload</code>. Calling either <code>Explore</code>, <code>Run</code>
or <code>RunAsync</code> will cause the tests to be loaded automatically.</p>
<p>The <code>Explore</code> methods returns an <code>XmlNode</code> containing the description of all tests found. The <code>Run</code> method returns an
<code>XmlNode</code> containing the results of every test. The XML format for results is the same as that for the exploration of
tests, with additional nodes added to indicate the outcome of the test. <code>RunAsync</code> returns an <code>ITestRun</code> interface,
which allows retrieving the XML result when it is complete.</p>
<p>The progress of a run is reported to the <code>ITestEventListener</code> passed to the run methods. Notifications received on this
interface are strings in XML format, rather than XmlNodes, so that they may be passed directly across a Remoting
interface.</p>
<h4 id="engine-services">Engine Services</h4>
<p>The engine <code>Services</code> property exposes the <code>IServiceLocator</code> interface, which allows the runner to use public services
of the engine.</p>
<pre><code class="lang-csharp">namespace NUnit.Engine
{
    /// &lt;summary&gt;
    /// IServiceLocator allows clients to locate any NUnit services
    /// for which the interface is referenced. In normal use, this
    /// limits it to those services using interfaces defined in the
    /// nunit.engine.api assembly.
    /// &lt;/summary&gt;
    public interface IServiceLocator
    {
        /// &lt;summary&gt;
        /// Return a specified type of service
        /// &lt;/summary&gt;
        T GetService&lt;T&gt;() where T : class;

        /// &lt;summary&gt;
        /// Return a specified type of service
        /// &lt;/summary&gt;
        object GetService(Type serviceType);
    }
}
</code></pre>
<p>The following services are available publicly.</p>
<table>
<thead>
<tr>
<th>Service</th>
<th>Interface</th>
<th>Function</th>
</tr>
</thead>
<tbody>
<tr>
<td>ExtensionService</td>
<td><a href="https://github.com/nunit/nunit-console/blob/main/src/NUnitEngine/nunit.engine.api/IExtensionService.cs">IExtensionService</a></td>
<td>Manages engine extensions</td>
</tr>
<tr>
<td>RecentFilesService</td>
<td><a href="https://github.com/nunit/nunit-console/blob/main/src/NUnitEngine/nunit.engine.api/IRecentFiles.cs">IRecentFiles</a></td>
<td>Provides information about recently opened files</td>
</tr>
<tr>
<td>ResultService</td>
<td><a href="https://github.com/nunit/nunit-console/blob/main/src/NUnitEngine/nunit.engine.api/IResultService.cs">IResultService</a></td>
<td>Produces test result output in various formats</td>
</tr>
<tr>
<td>SettingsService</td>
<td><a href="https://github.com/nunit/nunit-console/blob/main/src/NUnitEngine/nunit.engine.api/ISettings.cs">ISettings</a></td>
<td>Provides access to user settings</td>
</tr>
<tr>
<td>TestFilterService</td>
<td><a href="https://github.com/nunit/nunit-console/blob/main/src/NUnitEngine/nunit.engine.api/ITestFilterService.cs">ITestFilterService</a></td>
<td>Creates properly formed test filters for use by runners</td>
</tr>
<tr>
<td>LoggingService</td>
<td><a href="https://github.com/nunit/nunit-console/blob/main/src/NUnitEngine/nunit.engine.api/ILogging.cs">ILogging</a></td>
<td>Provides centralized internal trace logging for both the engine and runners (Not Yet Implemented)</td>
</tr>
</tbody>
</table>
<p>The following services are used internally by the engine but are not currently exposed publicly. They potentially could
be in the future:</p>
<table>
<thead>
<tr>
<th>Service</th>
<th>Function</th>
</tr>
</thead>
<tbody>
<tr>
<td>TestRunnerFactory</td>
<td>Creates test runners based on the TestPackage content</td>
</tr>
<tr>
<td>DomainManager</td>
<td>Creates and manages AppDomains used to run tests</td>
</tr>
<tr>
<td>DriverService</td>
<td>Provides the runner with a framework driver suitable for a given assembly</td>
</tr>
<tr>
<td>ProjectService</td>
<td>Is able to load assemblies referenced in various project formats</td>
</tr>
<tr>
<td>RuntimeFrameworkSelector</td>
<td>Determines the runtime framework to be used in running a test</td>
</tr>
<tr>
<td>TestAgency</td>
<td>Creates and manages Processes used to run tests</td>
</tr>
</tbody>
</table>
<h4 id="extensibility-interfaces">Extensibility Interfaces</h4>
<p>The API also contains various interfaces used by engine extensions. More information on these can be found in the
<a class="xref" href="extensions/Index.html">Engine Extensions</a> section.</p>

</article>
          </div>

          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/nunit/docs/blob/master/docs/articles/nunit-engine/Test-Engine-API.md/#L1" class="contribution-link">Edit this page</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
                <h5>In this article</h5>
                <div></div>
              </nav>
            </div>
          </div>
        </div>
      </div>

      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
      <span>Generated by <strong>DocFX</strong></span> | Copyright (c) 2018-<span id="currentYear"></span> The NUnit Project - Licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a>
      
          </div>
        </div>
      </footer>
    </div>

    <script type="text/javascript" src="../../styles/docfx.vendor.min.js"></script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
