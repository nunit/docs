<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Writing Engine Extensions | NUnit Docs </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Writing Engine Extensions | NUnit Docs ">
    <meta name="generator" content="docfx 2.45.1.0">
    
    <link rel="shortcut icon" href="../../../favicon.ico">
    <link rel="stylesheet" href="../../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../../styles/docfx.css">
    <link rel="stylesheet" href="../../../styles/main.css">
    <meta property="docfx:navrel" content="../../../toc.html">
    <meta property="docfx:tocrel" content="../../toc.html">
    
    
    
  </head>
  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../../../index.html">
                <img id="logo" class="svg" src="../../../logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="WritingEngineExtensions">
<h1 id="writing-engine-extensions">Writing Engine Extensions</h1>

<p>The NUnit Test Engine uses a plugin architecture that allows users and third parties to add new functionality to the engine. The extensibility model defines a number of Extension Points to which Extensions may be added. This page gives general information that applies to all types of extensions you may want to write. The individual pages for each type of extension give specific details. For a detailed description of the engine extensibility architecture, see <a class="xref" href="Engine-Extensibility.html">Engine Extensibility</a>.</p>
<h2 id="extension-attribute">Extension Attribute</h2>
<p>Every extension is implemented by a class with specific characteristics:</p>
<ul>
<li>Has a default constructor so that NUnit can create an instance.</li>
<li>Implements some interface that varies according to the particular extension.</li>
<li>Is marked with the <code>ExtensionAttribute</code> so that NUnit can recognize it as an extension.</li>
</ul>
<p>The code for a typical extension might look like this.</p>
<pre><code class="lang-csharp">[Extension]
public class MyExtension : ISomeInterface // Depending on the extension point
{
    // Your code here
}
</code></pre>
<p>The attribute has four named properties, all optional:</p>
<ul>
<li><p><strong>Path</strong> This is a string that uniquely identifies the extension point to which the extension applies. It is only rarely needed, since NUnit can usually deduce the type of extension based on what interface is implemented by the extension class.</p>
</li>
<li><p><strong>Description</strong> An optional description of what the extension does.</p>
</li>
<li><p><strong>Enabled</strong> A boolean flag indicating whether the extension is enabled. This defaults to true. The setting is used by advanced extensions with functionality that is turned on and off depending on user input.</p>
</li>
<li><p><strong>EngineVersion</strong> The minimum engine version supported by the extension. Although optional, you should use this property if your extension will not work with all versions of the engine. If you don't use it and your extension requires engine services that are not present, then it might throw an exception or cause other errors.</p>
</li>
</ul>
<div class="NOTE">
<h5>Note</h5>
<p>Only engine versions 3.4 or later check this property. The only way to avoid errors in the case of lower engine versions is to not install such extensions.</p>
</div>
<h2 id="extensionpropertyattribute">ExtensionPropertyAttribute</h2>
<p>Using only the <code>ExtensionAttribute</code>, NUnit would have to create instances of every extension in order to ask questions like &quot;What file extensions do you support.&quot; This would mean loading many potentially unneeded assemblies.</p>
<p>The <code>ExtensionPropertyAttribute</code> avoids the problem. NUnit's own extension for loading NUnit projects is a good example:</p>
<pre><code class="lang-csharp">[Extension]
[ExtensionProperty(&quot;FileExtension&quot;, &quot;.nunit&quot;)]
public class NUnitProjectLoader : IProjectLoader
{
    /* ... */
}
</code></pre>
<p>By use of the <code>ExtensionPropertyAttribute</code> NUnit is able to postpone loading the extension until the user actually uses a file of type <code>.nunit</code>. If the extension is never needed, then it won't be loaded at all. For information about what properties are used by each extension point, see the individual pages for each type of extension.</p>
<div class="NOTE">
<h5>Note</h5>
<p>Extensions are usually created each in their own assembly for efficiency. It's possible to have several related extensions in the same assembly, but they will all be loaded into memory as soon as one is used.</p>
</div>
<h2 id="kinds-of-extensions">Kinds of Extensions</h2>
<p>As of version 3.4, the NUnit Engine supports four types of extensions. The individual pages for each type give specific details on implementing each of them.</p>
<ul>
<li><a href="Project-Loaders.html">Project Loaders</a></li>
<li><a href="Result-Writers.html">Result Writers</a></li>
<li><a href="Framework-Drivers.html">Framework Drivers</a></li>
<li><a href="Event-Listeners.html">Event Listeners</a></li>
</ul>
<h2 id="installing-extensions">Installing Extensions</h2>
<p>Once an extension is written and compiled, it has to be placed somewhere such that NUnit will find it.</p>
<div class="NOTE">
<h5>Note</h5>
<p>This section is under construction. For now see the <a class="xref" href="Engine-Extensibility.html">Engine Extensibility page</a></p>
</div>
</article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/nunit/docs/blob/master/docs/articles/nunit/extending-nunit/Writing-Engine-Extensions.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span> | Copyright (c) 2018 The NUnit Project - Licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../../styles/main.js"></script>
  </body>
</html>
