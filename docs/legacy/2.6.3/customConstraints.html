<!DOCTYPE html>
<html lang="en">

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>NUnit.org</title>
  <meta name="description" content="NUnit is the most popular unit test framework for .NET.">

  <link rel="stylesheet" href="/css/main.css"">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
  <link rel="alternate" type="application/rss+xml" title="NUnit.org" href="/rss.xml"">
  <link rel="alternate" type="application/atom+xml" title="NUnit.org" href="/atom.xml" />
  <link rel="shortcut icon" href="/favicon.ico" />

  <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->
</head>

  <body>

    <nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container">
    <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="/">
            <div class="navbar-brand grow">
                <img src="/img/nunit.svg" />
            </div>
        </a>
    </div>
    <div id="navbar" class="collapse navbar-collapse">
        <ul class="nav navbar-nav">
            <li><a href="https://nunit.org/news/"><i class="fa fa-commenting-o"></i> News</a></li>
            <li><a href="https://nunit.org/download/"><i class="fa fa-download"></i> Download</a></li>
            <li><a href="https://docs.nunit.org"><i class="fa fa-book"></i> Documentation</a></li>
            <li><a href="https://nunit.org/contact/"><i class="fa fa-envelope-o"></i> Contact</a></li>
            <li><a href="https://twitter.com/nunit" target="_blank"><i class="fa fa-twitter"></i> Twitter</a></li>
            <li><a href="https://gitter.im/nunit/nunit" target="_blank"><i class="fa fa-comments-o"></i> Gitter</a></li>
            <li><a href="https://github.com/nunit" target="_blank"><i class="fa fa-github"></i> GitHub</a></li>
        </ul>
    </div><!--/.nav-collapse -->
    </div>
</nav>

  <div class="container">
    <div class="content help">
      <div class="notice">Legacy Documentation. View <a href="https://docs.nunit.org">NUnit 3 Documentation</a></div>
      <div id="help_content">

<h2>Custom Constraints (NUnit 2.4 / 2.5)</h2>

<p>You can implement your own custom constraints by creating a class that
inherits from the <b>Constraint</b> abstract class, which supports performing a
test on an actual value and generating appropriate messages. The class includes
two abstract methods, which you must override and four virtual methods with
default implementation that may be overridden as needed:

<div class="code" style="width: 36em">
<pre class="prettyprint">public abstract class Constraint
{
 	...
    public abstract bool Matches( object actual );
    public virtual bool Matches( ActualValueDelegate del );
    public virtual bool Matches&lt;T&gt;( ref T actual );
    public abstract void WriteDescriptionTo( MessageWriter writer );
    public virtual void WriteMessageTo( MessageWriter writer );
    public virtual void WriteActualValueTo( MessageWriter writer );
	...
}</pre>
</div>

<p>Your derived class should save the actual argument to Matches in the protected
field <b>actual</b> for later use.

<p>The MessageWriter abstract class is implemented in the framework by
TextMessageWriter. Examining the source for some of the builtin constraints
should give you a good idea of how to use it if you have special formatting
requirements for error messages.

<h3>Custom Constraint Syntax</h3>

<p>Having written a custom constraint class, you can use it directly through its constructor:

<div class="code"><pre class="prettyprint">Assert.That(myObject, new CustomConstraint());</pre>
</div>

<p>You may also use it in expressions through NUnit's <b>Matches</b> syntax element:
<div class="code"><pre class="prettyprint">Assert.That(myObject, Is.Not.Null.And.Matches(new CustomConstraint());</pre>
</div>

<p>The direct construction approach is not very convenient or easy to read.
For its built-in constraints, NUnit includes classes that implement a special
constraint syntax, allowing you to write things like...

<div class="code"><pre class="prettyprint">Assert.That( myArray, Is.All.InRange(1,100) );</pre>
</div>

<p>Ideally, that's what you would like to do with the custom constraint as well.
To accomplish this, two separate steps are required:

<ol>

<li>Provide a static class patterned after NUnit's <b>Is</b> class, with properties
or methods that constuct your custom constructor. If you like, you can even call it
<b>Is</b>, provided you place it in your own namespace and avoid any conflicts. This
allows you to write things like:

<div class="code"><pre class="prettyprint">Assert.That( myObject, Is.Custom(x,y) );</pre>
</div>

<li>Provide an extension method for NUnit's <b>ConstraintExpression</b>, allowing
you to write things like:

<div class="code"><pre class="prettyprint">Assert.That( myList, Is.Not.All.Custom(x,y) );</pre>
</div>

</ol>


</div>

<!-- Submenu -->
<div id="subnav">
<ul>
<li><a href="docHome.html">NUnit 2.6.3</a></li>
<ul>
<li><a href="getStarted.html">Getting&nbsp;Started</a></li>
<li><a href="writingTests.html">Writing&nbsp;Tests</a></li>
<li><a href="runningTests.html">Running&nbsp;Tests</a></li>
<li><a href="extensibility.html">Extensibility</a></li>
<ul>
<li id="current"><a href="customConstraints.html">Custom&nbsp;Constraints</a></li>
<li><a href="nunitAddins.html">NUnit&nbsp;Addins</a></li>
<li><a href="extensionTips.html">Tips&nbsp;for&nbsp;Extenders</a></li>
</ul>
<li><a href="releaseNotes.html">Release&nbsp;Notes</a></li>
<li><a href="samples.html">Samples</a></li>
<li><a href="license.html">License</a></li>
</ul>
<li><a href="&r=2.6.3.html"></a></li>
</ul>
</div>
<!-- End of Submenu -->



    </div>
  </div>

  <script src="/js/jquery.min.js"></script>
  <script src="/js/codeFuncs.js"></script>

    <footer class="footer">
  <div class="container">
    <div class="row text-muted">
      <div class="col-sm-8">
        NUnit 2 Documentation Copyright &copy; 2014, Charlie Poole. All rights reserved.
      </div>
      <div class="col-sm-4 text-right">
        Supported by the
        <a href="https://dotnetfoundation.org/">.NET Foundation</a>
      </div>
    </div>
  </div>
</footer>

<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="/js/bootstrap.min.js"></script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-7904234-12', 'auto');
  ga('send', 'pageview');

</script>

  </body>
</html>
